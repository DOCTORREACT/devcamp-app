import React, { useState } from 'react'
import { NavLink, Redirect } from "react-router-dom";
import axios from "axios";
import './ResetPassword.css'

import Input from 'components/Input/Input'
import Button from 'components/Button/Button'

 const resetUrl = 'http://devcamp-api-node.herokuapp.com/api/v1/auth/resetpassword/cd4739d9ae2f1b04299c99e1d4c2bfa0046caf77'

const ResetPassword = props => {

    const [email, setEmail] = useState('')
    const [successful, setSuccessful] = useState(false)

    const submitHandler = e => {
        e.preventDefault()
        
        const userEmail = { email }

        axios.put(resetUrl, userEmail, {
             headers: {
                'Authorization': `Bearer ${localStorage.getItem('token')}` 
               }
            })
            .then(() => { setSuccessful(true)} )
            .catch(error => { console.log('error ->',error) })
    }

    const inputChangeHandler = e => {
        setEmail(e.target.value)
    }

    if(successful) {
        return <Redirect to={'/'} />
    }

    return (
        <div className={'reset_container'} >
            <form onSubmit={submitHandler} className={'reset_form'} method='put'>
                <div>
                    <NavLink to={'/login'} className={'toLogin_link'}>Back to login</NavLink>
                </div>
                    <div className={'reset_title'}><p>Reset Password</p></div>
                    <p>Use this form to reset your password using the registered email address.</p>
                    <p className={'reset_label'}> Email</p>
                <Input
                    className={'reset'}
                    title={'Enter Email'}
                    onChangeInput={inputChangeHandler}
                />
                <Button className={'reset'} title={'Reset'} width={'100%'} />
            </form>
        </div>
    )
}

export default ResetPassword
